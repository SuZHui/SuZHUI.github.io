<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.9be5edc09e5f541900d9.css">@import url(https://unpkg.com/tachyons@4.10.0/css/tachyons.min.css);@import url(https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/3.0.1/github-markdown.min.css);.scroll-top-enter{transform:translateY(-100%)}.scroll-top-enter-done{transform:translateY(0)}.scroll-top-enter-active{transform:translateY(0);transition:transform .4s ease}.scroll-top-exit{transform:translateY(0)}.scroll-top-exit-active,.scroll-top-exit-done{transform:translateY(-100%)}.scroll-top-exit-active{transition:transform .4s ease}.fade-enter{opacity:0}.fade-enter-done{opacity:1;display:inherit}.fade-enter-active{opacity:1;transition:opacity .4s ease}.fade-exit{opacity:1}.fade-exit-done{opacity:0;display:none}.fade-exit-active{opacity:0;transition:opacity .4s ease}.slide-right-enter{transform:translateX(-100%)}.slide-right-enter-done{transform:translateX(0)}.slide-right-enter-active{transform:translateX(0);transition:transform .5s ease-in}.slide-right-exit{transform:translateY(0)}.slide-right-exit-active,.slide-right-exit-done{transform:translateX(-100%)}.slide-right-exit-active{transition:transform .5s ease-out}.animation-slide{animation:slide 3.4s ease;animation-iteration-count:infinite;transform-origin:50% 50%;animation-play-state:running}@keyframes slide{0%{opacity:0;transform:translateY(0)}40%{opacity:1;transform:translateY(-2px)}to{opacity:1;transform:translateY(-2px)}}.f8{font-size:.64rem}*{margin:0;-webkit-margin-before:0;margin-block-start:0;-webkit-margin-after:0;margin-block-end:0;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:0;margin-inline-end:0;-webkit-padding-start:0;padding-inline-start:0}html{background-color:#fff;font:15.17241px Open Sans,sans-serif;font-size:22px;left:0;top:0;right:0;bottom:0}div{box-sizing:border-box}button,input{border:none;background:transparent}button:focus,input:focus{border:none;outline:none}button{cursor:pointer}.icon-module--scroll-top-enter--9iYRW{transform:translateY(-100%)}.icon-module--scroll-top-enter-done--Hfcoz{transform:translateY(0)}.icon-module--scroll-top-enter-active--2KCYe{transform:translateY(0);transition:transform .4s ease}.icon-module--scroll-top-exit--1RJ-n{transform:translateY(0)}.icon-module--scroll-top-exit-done--QoT6-{transform:translateY(-100%)}.icon-module--scroll-top-exit-active--2hMGg{transform:translateY(-100%);transition:transform .4s ease}.icon-module--fade-enter--R8jwX{opacity:0}.icon-module--fade-enter-done--2g7Hl{opacity:1;display:inherit}.icon-module--fade-enter-active--2Mhrs{opacity:1;transition:opacity .4s ease}.icon-module--fade-exit--2Xhod{opacity:1}.icon-module--fade-exit-done--1gRHa{opacity:0;display:none}.icon-module--fade-exit-active--3bnfy{opacity:0;transition:opacity .4s ease}.icon-module--slide-right-enter--OulX9{transform:translateX(-100%)}.icon-module--slide-right-enter-done--j1TCQ{transform:translateX(0)}.icon-module--slide-right-enter-active--1UNFo{transform:translateX(0);transition:transform .5s ease-in}.icon-module--slide-right-exit--24YZ0{transform:translateY(0)}.icon-module--slide-right-exit-done--1fj_0{transform:translateX(-100%)}.icon-module--slide-right-exit-active--zbjW3{transform:translateX(-100%);transition:transform .5s ease-out}.icon-module--animation-slide--4rkyj{animation:icon-module--slide--3uyL4 3.4s ease;animation-iteration-count:infinite;transform-origin:50% 50%;animation-play-state:running}@keyframes icon-module--slide--3uyL4{0%{opacity:0;transform:translateY(0)}40%{opacity:1;transform:translateY(-2px)}to{opacity:1;transform:translateY(-2px)}}.icon-module--f8--1Ee8n{font-size:.64rem}@font-face{font-family:blog-icon;src:url(https://at.alicdn.com/t/font_1257231_h98swvb4mt8.eot);src:url(https://at.alicdn.com/t/font_1257231_h98swvb4mt8.eot#iefix) format("embedded-opentype"),url(https://at.alicdn.com/t/font_1257231_h98swvb4mt8.woff2) format("woff2"),url(https://at.alicdn.com/t/font_1257231_h98swvb4mt8.woff) format("woff"),url(https://at.alicdn.com/t/font_1257231_h98swvb4mt8.ttf) format("truetype"),url(https://at.alicdn.com/t/font_1257231_h98swvb4mt8.svg#blog-icon) format("svg")}.icon-module--icon--27QhR{font-family:blog-icon!important;font-style:normal;-webkit-font-smoothing:antialiased;-webkit-text-stroke-width:.2px;-moz-osx-font-smoothing:grayscale}.icon-module--icon--27QhR.icon-module--search--3VLx8:before{content:"\E6C8"}.icon-module--icon--27QhR.icon-module--back-top--3clpO:before{content:"\E655"}.page-layout-module--page-layout--ppHDr{width:100vw;height:100vh;overflow-x:hidden;overflow-y:scroll}.page-layout-module--page-layout--ppHDr::-webkit-scrollbar{width:10px}.page-layout-module--page-layout--ppHDr::-webkit-scrollbar-track{background:#eee}.page-layout-module--page-layout--ppHDr::-webkit-scrollbar-thumb{background:#888;border-radius:6px}</style><meta name="generator" content="Gatsby 2.24.84"/><title data-react-helmet="true">Just A Little - 在项目中使用TypeScript</title><link as="script" rel="preload" href="/webpack-runtime-3c1de529aaa4c3f65afe.js"/><link as="script" rel="preload" href="/framework-fc9659a3b74fac5c7369.js"/><link as="script" rel="preload" href="/app-062ebd3a652285c14ef0.js"/><link as="script" rel="preload" href="/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/0b059ea0674e65ec2a929c391246ed87fd641d57-12a4597ec79108c4c8b9.js"/><link as="script" rel="preload" href="/014b944be68ff1ab3ae0248dad59894df98e87d4-066602587adc49b98a18.js"/><link as="script" rel="preload" href="/component---src-template-blog-post-js-1b6c6af8148d92eabf72.js"/><link as="fetch" rel="preload" href="/page-data/article/BFE1A715482A3D29/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/4224293195.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="overflow-hidden absolute absolute--fill page-layout-module--page-layout--ppHDr"><header class="fixed top-0 left-0 right-0 w-100 z-9999 bg-white overflow-hidden shadow-2 pv1 ph2"><div class="center pv1 ph2 flex w-100 w-60-ns" style="flex-direction:row;justify-content:space-between;align-items:center"><a class="link orange" href="/"><h2 class="f6 normal">Just A Little</h2></a><div><a class="link orange" href="/tags/"><i class="icon-module--icon--27QhR icon-module--search--3VLx8" style="font-size:22px;color:"></i></a></div></div></header><div class="pv3 mt3 ph2"><div class="center pv1 ph2 flex w-100 w-60-ns" style="flex-direction:column;justify-content:start;align-items:center"><h1 class="f3 normal">在项目中使用TypeScript</h1><div class="markdown-body w-100"><h2>TypeScript是什么</h2>
<blockquote>
<p>TypeScript是JavaScript的一个超集,主要提供了<code>类型系统</code>和对<code>ES6</code>的支持,可编译成纯JavaScript。
它由Microsoft开发，代码开源在<a href="https://github.com/Microsoft/TypeScript">GitHub</a>上。</p>
</blockquote>
<h2>为什么选择TypeScript</h2>
<h3>TypeScript 增加了代码的可读性和可维护性</h3>
<ul>
<li>类型系统实际上是最好的文档，大部分的函数看看类型的定义就可以知道如何使用了</li>
<li>可以在编译阶段就发现大部分错误，这总比在运行时候出错好</li>
<li>增强了编辑器和 IDE 的功能，包括代码补全、接口提示、跳转到定义、重构等</li>
</ul>
<h3>TypeScript 非常包容</h3>
<ul>
<li>TypeScript 是 JavaScript 的超集，.js 文件可以直接重命名为 .ts 即可</li>
<li>即使不显式的定义类型，也能够自动做出类型推论</li>
<li>可以定义从简单到复杂的几乎一切类型</li>
<li>即使 TypeScript 编译报错，也可以生成 JavaScript 文件</li>
<li>兼容第三方库，即使第三方库不是用 TypeScript 写的，也可以编写单独的类型文件供 TypeScript 读取</li>
</ul>
<h3>TypeScript 拥有活跃的社区</h3>
<ul>
<li>大部分第三方库都有提供给 TypeScript 的类型定义文件</li>
<li>Google 开发的 Angular2 就是使用 TypeScript 编写的</li>
<li>TypeScript 拥抱了 ES6 规范，也支持部分 ESNext 草案的规范</li>
</ul>
<h3>TypeScript 的缺点</h3>
<p>任何事物都是有两面性的，我认为 TypeScript 的弊端在于：</p>
<ul>
<li>有一定的学习成本，需要理解接口（Interfaces）、泛型（Generics）、类（Classes）、枚举类型（Enums）等前端工程师可能不是很熟悉的概念</li>
<li>短期可能会增加一些开发成本，毕竟要多写一些类型的定义，不过对于一个需要长期维护的项目，TypeScript 能够减少其维护成本</li>
<li>集成到构建流程需要一些工作量</li>
<li>可能和一些库结合的不是很完美</li>
</ul>
<h2>在前端项目中使用TypeScript</h2>
<p>以下只列举一些开发中用到的功能，详细的TS指南可以查看<a href="https://www.tslang.cn/">官方文档</a></p>
<h3>对api模块的改造</h3>
<p>下面是对一个api模块的改造，对原有的接口入参和返回做了类型定义，这样在进行开发和维护时，只要查看这些类型定义，就可以快速的获取该接口返回的正确数据类型。方便下一步的本地数据使用和业务逻辑处理。</p>
<p>改造前</p>
<pre><code class="language-js">import { http } from '@plugin/http'
export default {
  /**
   * 获取可配置的权限列表
   */
  getConfigurablePermissionList (companyId = null) {
    return http('/menu/getMenu', { companyId })
  }
}
</code></pre>
<p>改造后</p>
<pre><code class="language-ts">import { http } from '@plugin/http'
import { PermissionData } from '@type/response'

interface IBaseResponse {
  code: number,  
  data: PermissionData,
  msg: string | nulls
}

export default {
  /**
   * 获取可配置的权限列表
   */
  getConfigurablePermissionList (companyId: number | null)
  : Promise&#x3C;IBaseResponse>
  {
    return http('/menu/getMenu', { companyId })
  }
}
</code></pre>
<h3>对组件及业务的类型校检进行改造</h3>
<p>对函数进行参数校验，对参数和变量进行了强类型约束，在编码阶段就能获得对应的类型提示，避免了很多在运行时才能发现的类型错误。</p>
<p>改造前</p>
<pre><code class="language-js">const STATE = {
  TO_BE_DONE: 0,
  DOING:1,
  DONE: 2
}

function useState (state) {
  if (state &#x26;&#x26; state.DOING &#x26;&#x26; state.DOING === 1) {
    // 进行业务代码的编写...
  }
}

useState(STATE.DOING)
</code></pre>
<p>改造后</p>
<pre><code class="language-ts">// 定义枚举
const enum STATE {
  TO_BE_DONE = 0,
  DOING = 1,
  DONE = 2
}

function useState (state: STATE): void {
  if (state === STATE.DOING) {
    // 直接进行业务代码的编写...
  }
}

useState(STATE.DOING)
</code></pre>
<p>其它常见的问题就是涉及严格的空值检查，即使用属性来构造或尝试调用可能为 null 或 undefined 的内容，在编码阶段就能获得IDE的警告。
另一种是变量类型不匹配的问题，当我们尝试使用彼此不匹配的类型时,同样在开发阶段TypeScript就会提示我们，从而在上线之前减少这类bug的出现。</p>
<h2>写在最后</h2>
<p>目前Vue（2.x）与TS的契合度不够好，如果只是练手不建议直接在生产中使用。Vue 3.x出来之后将会更好的支持TS（尤小佑说的），可以在3.x出来前在自己的小项目里多玩玩<code>TS</code> 和 <code>React hooks</code> 。</p></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/article/BFE1A715482A3D29";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-114f40ce2df640dad463.js"],"app":["/app-062ebd3a652285c14ef0.js"],"component---src-pages-404-js":["/component---src-pages-404-js-a451697af6272020102b.js"],"component---src-pages-index-js":["/component---src-pages-index-js-5ca3c0d0e0a13dbf3706.js"],"component---src-pages-tags-js":["/component---src-pages-tags-js-5ac138dfe5ee8993350e.js"],"component---src-template-blog-post-js":["/component---src-template-blog-post-js-1b6c6af8148d92eabf72.js"],"component---src-template-tags-page-js":["/component---src-template-tags-page-js-c073543dca604a9227fa.js"]};/*]]>*/</script><script src="/polyfill-114f40ce2df640dad463.js" nomodule=""></script><script src="/component---src-template-blog-post-js-1b6c6af8148d92eabf72.js" async=""></script><script src="/014b944be68ff1ab3ae0248dad59894df98e87d4-066602587adc49b98a18.js" async=""></script><script src="/0b059ea0674e65ec2a929c391246ed87fd641d57-12a4597ec79108c4c8b9.js" async=""></script><script src="/styles-407fe62976dc5310c43e.js" async=""></script><script src="/app-062ebd3a652285c14ef0.js" async=""></script><script src="/framework-fc9659a3b74fac5c7369.js" async=""></script><script src="/webpack-runtime-3c1de529aaa4c3f65afe.js" async=""></script></body></html>